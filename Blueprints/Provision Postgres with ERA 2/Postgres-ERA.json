{"status":{},"contains_secrets":true,"product_version":"3.2.0","spec":{"description":"dbname: @@{Era.DB_ENTITY_NAME}@@\n","resources":{"client_attrs":{"None":{"y":443,"x":658.75},"17264844_deployment":{"y":-294.9787719025,"x":472.7787478433},"f6be2786_deployment":{"y":-18.9914211803,"x":376.6179308499},"f9a4c530_deployment":{"y":-310.0361260204,"x":44.7810968508},"0c1048b2-2db1-40d0-8f82-873b74c2e97b":{"y":11.5,"x":674.6171875}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0bfadcbf_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"975ed99a_runbook","main_task_local_reference":{"kind":"app_task","name":"0bfadcbf_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Flow Del Category"}],"name":"9ade3d68_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Flow Del Category","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"c8712657_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"cf884050_runbook","main_task_local_reference":{"kind":"app_task","name":"9ade3d68_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1124d60e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6bcf94d3_runbook","main_task_local_reference":{"kind":"app_task","name":"1124d60e_dag"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0ae24e3c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"84c12573_runbook","main_task_local_reference":{"kind":"app_task","name":"0ae24e3c_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bf858e3b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6e2e5ff2_runbook","main_task_local_reference":{"kind":"app_task","name":"bf858e3b_dag"},"variable_list":[]},"name":"action_stop"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Del Category Value"}],"name":"306b2064_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Del Category Value","attrs":{"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\nuuid = \"@@{DB_SERVER_VM_UUID}@@\"\n\nprint \"local UUID\" + uuid\n\ndef process_request(url, method, user, password, headers, payload=None):\n  r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n  return r\n\npayload = {\"length\":500}\n\nbase_url = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/vms\"\nurl = base_url + \"\/\" + uuid\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\nurl_method = \"GET\"\n\nr = process_request(url, url_method, user, password, headers, json.dumps(payload))\nprint \"Response Status: \" + str(r.status_code)\nvm_json = r.json()\n\ndel vm_json['status']\nvm_json['metadata']['categories'] = {}\n\nprint \"Categories: \" + json.dumps(vm_json['metadata']['categories'])\nprint \"VM JSON: \" + json.dumps(vm_json)\n\nurl = base_url + \"\/\" + str(vm_json['metadata']['uuid'])\nurl_method = \"PUT\"\nr = process_request(url, url_method, user, password, headers, json.dumps(vm_json))\nprint \"Response Status: \" + str(r.status_code)\nprint \"Response: \", r.json()\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c8712657_runbook","main_task_local_reference":{"kind":"app_task","name":"306b2064_dag"},"variable_list":[]},"name":"Flow Del Category"}],"depends_on_list":[{"kind":"app_service","name":"Flow"}],"name":"Era","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CLEANUP_OPERATION_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CLUSTER_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COMPUTE_PROF_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CREATE_OPERATION_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_ENTITY_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_PARAM_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_SERVER_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_SERVER_IP","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DEREGISTER_OPERATION_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"NETWORK_PROF_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SLA_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SOFTWARE_PROF_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_SERVER_NAME","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DB_SERVER_VM_UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false}],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Flow Add Category"}],"name":"6fba9cbb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Flow Add Category","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"c1103d1f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"01945104_runbook","main_task_local_reference":{"kind":"app_task","name":"6fba9cbb_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"8bee20f0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"fe42eb38_runbook","main_task_local_reference":{"kind":"app_task","name":"8bee20f0_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"04cc6e24_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffd25064_runbook","main_task_local_reference":{"kind":"app_task","name":"04cc6e24_dag"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9d7e4dfb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ef6acd35_runbook","main_task_local_reference":{"kind":"app_task","name":"9d7e4dfb_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"897e9b24_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"b81e8f8b_runbook","main_task_local_reference":{"kind":"app_task","name":"897e9b24_dag"},"variable_list":[]},"name":"action_stop"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"304a6826_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d8232a1b_runbook","main_task_local_reference":{"kind":"app_task","name":"304a6826_dag"},"variable_list":[]},"name":"Epoch Registration"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Category Value"}],"name":"4d167183_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Add Category Value","attrs":{"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\ndbname = \"@@{Era.DB_SERVER_NAME}@@\"\n\ndef process_request(url, method, user, password, headers, payload=None):\n  r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n  return r\n\npayload = {\"length\":500}\n\nbase_url = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/vms\"\nurl = base_url + \"\/list\"\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\nurl_method = \"POST\"\n\nr = process_request(url, url_method, user, password, headers, json.dumps(payload))\nprint \"Response Status: \" + str(r.status_code)\nvm_list_json = r.json()\nfor vm in vm_list_json['entities']:\n  if vm['spec']: #sometimes this value will be '{}'\n    if (vm['spec']['name'] == dbname):\n      uuid = vm['metadata']['uuid']\n\nprint \"uuid is: \" + uuid\nprint \"VM_UUID is: \" + \"@@{Era.DB_SERVER_VM_UUID}@@\"\n\n#using GET instead of '\/list'\nurl = base_url + \"\/\" + str(uuid)\nurl_method = \"GET\"\nr = process_request(url, url_method, user, password, headers, '')\nprint \"Response Status: \" + str(r.status_code)\nvm_json = r.json()\nprint \"GET: \" + json.dumps(vm_json)\n\ndel vm_json['status']\nvm_json['metadata']['categories']['Environment'] = \"@@{calm_application_name}@@\"\nvm_json['metadata']['categories']['AppTier'] = \"DB\"\nvm_json['metadata']['categories']['AppType'] = \"Default\"\n\nprint \"Categories: \" + json.dumps(vm_json['metadata']['categories'])\nprint \"VM JSON: \" + json.dumps(vm_json)\n\nurl = base_url + \"\/\" + str(vm_json['metadata']['uuid'])\nurl_method = \"PUT\"\nr = process_request(url, url_method, user, password, headers, json.dumps(vm_json))\nprint \"Response Status: \" + str(r.status_code)\nprint \"Response: \", r.json()\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1103d1f_runbook","main_task_local_reference":{"kind":"app_task","name":"4d167183_dag"},"variable_list":[]},"name":"Flow Add Category"}],"depends_on_list":[{"kind":"app_service","name":"Flow"}],"name":"Postgres","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"UUID","value":"","label":"","attrs":{"type":""},"is_hidden":false}],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"90c0c5e3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"92b6d4f0_runbook","main_task_local_reference":{"kind":"app_task","name":"90c0c5e3_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"eb4b50c2_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"62bd3161_runbook","main_task_local_reference":{"kind":"app_task","name":"eb4b50c2_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a2c2f1cf_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"65935808_runbook","main_task_local_reference":{"kind":"app_task","name":"a2c2f1cf_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2ac813b0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5c0f6744_runbook","main_task_local_reference":{"kind":"app_task","name":"2ac813b0_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"84fb7f0b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"88bdd252_runbook","main_task_local_reference":{"kind":"app_task","name":"84fb7f0b_dag"},"variable_list":[]},"name":"action_restart"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CreateCategory"}],"name":"78bc726b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateCategory","attrs":{"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\n\ndef process_request(url, method, user, password, headers, payload=None):\n    r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n    return r\n\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\n\n#AppTier\/DB if not existed\nurl = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/categories\/AppTier\/DB\"\nurl_method = \"PUT\"\npayload = {\"value\": \"DB\",\"description\":\"DB\"}\nr = process_request(url, url_method, user, password, headers, json.dumps(payload))\nprint \"Response Status: \" + str(r.status_code)\nprint \"Response: \", r.json()\n\n#environment\nurl = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/categories\/Environment\/@@{calm_application_name}@@\"\nurl_method = \"PUT\"\npayload = {\"value\": \"@@{calm_application_name}@@\",\"description\":\"@@{calm_application_name}@@ environment\"}\nr = process_request(url, url_method, user, password, headers, json.dumps(payload))\nprint \"Response Status: \" + str(r.status_code)\nprint \"Response: \", r.json()\n\n\n\n\n\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3b58a035_runbook","main_task_local_reference":{"kind":"app_task","name":"78bc726b_dag"},"variable_list":[]},"name":"Create Category"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CreatePolicy1"}],"name":"2c84755f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreatePolicy1","attrs":{"exit_status":[],"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\n\ndef process_request(url, method, user, password, headers, payload=None):\n    r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n    return r\n\nurl = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/network_security_rules\"\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\nurl_method = \"POST\"\n\npayload = {\n    \"metadata\": {\n        \"kind\": \"network_security_rule\",\n        \"categories\": {},\n        \"spec_version\": 0\n    },\n    \"spec\": {\n        \"description\": \"@@{calm_application_name}@@\",\n        \"resources\": {\n            \"app_rule\": {\n                \"action\": \"MONITOR\",\n                \"outbound_allow_list\": [],\n                \"target_group\": {\n                    \"filter\": {\n                        \"params\": {\n                            \"Environment\": [\n                                \"@@{calm_application_name}@@\"\n                            ],\n                            \"AppType\": [\n                                \"Default\"\n                            ],\n                            \"AppTier\": [\n                                \"DB\"\n                            ]\n                        },\n                        \"kind_list\": [\n                            \"vm\"\n                        ],\n                        \"type\": \"CATEGORIES_MATCH_ALL\"\n                    },\n                    \"default_internal_policy\": \"ALLOW_ALL\",\n                    \"peer_specification_type\": \"FILTER\"\n                },\n                \"inbound_allow_list\": [\n                    {\n                        \"filter\": {\n                            \"params\": {\n                                \"Environment\": [\n                                    \"@@{calm_application_name}@@\"\n                                ],\n                                \"AppType\": [\n                                    \"Default\"\n                                ],\n                                \"AppTier\": [\n                                    \"App\"\n                                ]\n                            },\n                            \"kind_list\": [\n                                \"vm\"\n                            ],\n                            \"type\": \"CATEGORIES_MATCH_ALL\"\n                        },\n                        \"tcp_port_range_list\": [\n                            {\n                                \"end_port\": 5432,\n                                \"start_port\": 5432\n                            }\n                        ],\n                        \"protocol\": \"TCP\",\n                        \"peer_specification_type\": \"FILTER\"\n                    },\n                    {\n                        \"filter\": {\n                            \"params\": {\n                                \"Environment\": [\n                                    \"@@{calm_application_name}@@\"\n                                ],\n                                \"AppType\": [\n                                    \"Default\"\n                                ],\n                                \"AppTier\": [\n                                    \"App\"\n                                ]\n                            },\n                            \"kind_list\": [\n                                \"vm\"\n                            ],\n                            \"type\": \"CATEGORIES_MATCH_ALL\"\n                        },\n                        \"protocol\": \"UDP\",\n                        \"udp_port_range_list\": [\n                            {\n                                \"end_port\": 5432,\n                                \"start_port\": 5432\n                            }\n                        ],\n                        \"peer_specification_type\": \"FILTER\"\n                    }\n                ]\n            }\n        },\n        \"name\": \"@@{calm_application_name}@@\"\n    }\n}\n\n\n\nprint \"Payload: \" + json.dumps(payload)\n\nr = process_request(url, url_method, user, password, headers, json.dumps(payload))\nprint \"Response Status: \" + str(r.status_code)\nprint \"Response: \", r.json()\n\nprint \"policy_uuid_1=\", r.json()['metadata']['uuid']\n","eval_variables":["policy_uuid_1"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"172074d8_runbook","main_task_local_reference":{"kind":"app_task","name":"2c84755f_dag"},"variable_list":[]},"name":"Create Policy"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"DeletePolicy"}],"name":"27a19187_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeletePolicy","attrs":{"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\n\ndef process_request(url, method, user, password, headers, payload=None):\n    r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n    return r\n\nurl = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/network_security_rules\/@@{policy_uuid_1}@@\"\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\nurl_method = \"DELETE\"\nr = process_request(url, url_method, user, password, headers)\nprint \"Response Status: \" + str(r.status_code)\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"b0ce783a_runbook","main_task_local_reference":{"kind":"app_task","name":"27a19187_dag"},"variable_list":[]},"name":"Delete Policy"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"DeleteCategory"}],"name":"d0b36d6d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeleteCategory","attrs":{"script":"user = \"@@{pc_username}@@\"\npassword = \"@@{pc_password}@@\"\nip = \"@@{pc_ip}@@\"\n\ndef process_request(url, method, user, password, headers, payload=None):\n    r = urlreq(url, verb=method, auth=\"BASIC\", user=user, passwd=password, params=payload, verify=False, headers=headers)\n    return r\n\nurl = \"https:\/\/\" + ip + \":9440\/api\/nutanix\/v3\/categories\/Environment\/@@{calm_application_name}@@\"\nheaders = {'Accept': 'application\/json', 'Content-Type': 'application\/json'}\nurl_method = \"DELETE\"\nr = process_request(url, url_method, user, password, headers)\nprint \"Response Status: \" + str(r.status_code)\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"771ebc6f_runbook","main_task_local_reference":{"kind":"app_task","name":"d0b36d6d_dag"},"variable_list":[]},"name":"Delete Category"}],"depends_on_list":[],"name":"Flow","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"policy_uuid_1","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"policy_uuid_2","value":"","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"policy_uuid_3","value":"","label":"","attrs":{"type":""},"is_hidden":false}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"EXISTING_VM","name":"EraServer","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{ip_address}@@","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"era_creds"}},"os_type":"Linux","create_spec":{"type":"PROVISION_EXISTING_MACHINE","address":"@@{era_ip}@@"},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"Era_PostgreSQL_DB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f6c3a68b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d80b0004_runbook","main_task_local_reference":{"kind":"app_task","name":"f6c3a68b_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"Era_PostgreSQL_DB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c12ce58e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1d7e3c3b_runbook","main_task_local_reference":{"kind":"app_task","name":"c12ce58e_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"EXISTING_VM","name":"Era_PostgreSQL_DB","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{ip_address}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"db_server_creds"}},"os_type":"Linux","create_spec":{"type":"PROVISION_EXISTING_MACHINE","address":"@@{Era.DB_SERVER_IP}@@"},"variable_list":[]},{"description":"","action_list":[],"type":"EXISTING_VM","name":"FlowIngegration","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{ip_address}@@","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"os_type":"Linux","create_spec":{"type":"PROVISION_EXISTING_MACHINE","address":"0.0.0.0"},"variable_list":[]}],"credential_definition_list":[{"username":"era","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"PjHJ5bfQbEtspwJFISWchAZLJQt5lKnw6VH8N74z2eqJziS+jZ2+JWncYMLym2B6R3+aqXXRXqFqCkeFrOCZlUa+UE3xZRNHp231ESPjRvPSzKsG696f86dkUtEYVj54iyEYpFdg\/FsioXfsPBN2itgc48ZMaIAIcsTfGBimcXxBoRDduG5ddTgAfVUebmZSjAkrOFPFqF\/qS+v3z\/eJ0ZWkE6uQGyL3QTMV6PxpF\/rHVQn0vqm+IReYQSAb0xfC0HqIGzcuLKD7bolbyv4ukcN\/NO6isQ2UMn2aXFQaj+cB0DskBQIs4GZElMJ3crbI5woEMEORbRw+yki7scGIMPeEShow4izcXj10whZZzoh6TuSZfYPm\/+nQjf4GeSfmYwUSIusLkbFMLmveCYJWgqGDAhS1hIL7tXzuLhlxfhIJ77hn4A1Q7dHgtMXPXU7VC\/7kddrW1S4nw6VcvGSa1qNWYQ8RtHVq9FehUbFIUOdYR7Vnu6XR\/SGlqz8ZV6xSd+T4icmc7sMoj80RNmMTNt+\/Xyl2z\/wT3NIejWigs\/DHsSCjNMcG5fB6RsI3577ueFq7pVCdSqXg7EVPvGMPno53mRSVuJlI00CXFI91pJ+NiJo+LvtooH4rrTbKNbcWAWws3JgHufp4+N7UsJPbwKfOC6ond53r4R0Ezai\/0UZR4pRbtqMNPgjdRMVGPKEJssXkXRhMi6JKbX4QG0SM9T5P8jp9MjFEjV2T4lC8LhuWvfDhhkwGCi4kFwE3zoOOou8Ikm9NZh7DitFOfj1tShe+QO0G5MU6fQcuZQvlDAjvXuxkrpjJpRTlClj4vWI8toXdmE+XZzK46afx5A6pHT+tObMVNx81SwTpUluyvwPmghi\/b9iEH+4JwrjYVwfYezQHDFpFtWBQU4oO6hvfe9KAI6k\/rlEMCfIk4Qd6aiKdkfAjpTWXC5703hbTOtBP\/r00xZSw+0aBNL14v16G0ahK2MsFpeQMgGwvfSOdzJ5Uhm08\/E2xK4z7fXYfA9zUZPZnoyChVbXdVs2OOTan5kKgBs6LGTMoPF7eC6sbJu3Z1aoAN+zMLco02tqujixKoX2oZHumQB2qjwDoC61EA2rk3+4oi8PXXYNPLrKINwS+muh0Vm5PedVA6n22bECpNaG6sLNK7oDhITSCAVDo9VP+HlPY7WU1KxSnqoiRo05Ne90aa010LgGKaE1I7MMdp9xDY3Gvnkbi6JWIJON+M9ssa17ySbF5H\/JV4Y\/UXCheNWHOIIQnoaoac+5k9aOs9lYRRm0OVj4Xw2OKTzcnwzb7FmH2JqXL4BIxEEQTl8xoMgvJzGqf91Cet28hbcIWQg1Q+F\/LA38n2FLlw7V+2jwZAeYc\/ByneAvPIpsexCNcziP3HSgjRBbCg445HZGxOsA0CQ1Y8\/qbfTYLcgtvVZ8JiIpa7YcpdHkcvSz+yTfuRBCkqgyrfSHMK69ylxpKE3Iki1RBOsiQtNpRG1L4kbUiuk0axGCJ2mcNtdMbEkjHWtmIXZyEkMbJ5LTicDDcYGDxdbfuMdCF1tEVeYgvdNHzRxbzvDQKt\/IrICQJUrq6B3iWynjF1dmUVyJDYtUQRLzF4NsZrXpb31iXFFdK+O\/O8mbypDUdaYrAbBH1UCGRAKdxadL5R7np4zcn+JTLRvxSVlzHmjuwgTBSTD2j\/4xmprqkklgBYhSvohKIqHoImnSywQOZYiVPuolvWlch6j44tUeuC\/9KqaeBvawgSskAfERRmo9WAThi2HWd51pp6EgyHxT90ArCGJz8IvQl6Xa8PtNsyj5Ih193uZ1P0JaKwg\/7Ymu9kMQHROXIOWYQBHiTO81FXfDlAQOXNczma82K948OcXzWexHrtSXbZjOwQNvaBC9EuX3cufkuwQFmgAve+jbGNr5CJN3tGXU5EPw214jDiq70c9PBW5WUtc8Dm8KITGb27fbvqiweszqsB8tSCipN4pD27HJRf\/eyEd8OYm8CoH++MpWcFV+Ol3vr7EiAVmIzgIq2OJFyK1xZ9eL2DjkCLNQO6QxGhwETqvukRiQL36g5hK0CI56LDXoPyHzpTUvVhyb8zC2isLRfOzFktX5+OJsF+PtQArH15kY75HDZX2kGY7X12B8XeHqe27uqH2hlCtQiUQHOr\/D768Dc7oBJW\/OXVen3\/X8qgNkDN+lOgCwGDDBBOeZVW3S\/3xrh5qKrBzS23AWUHXfi0MFBWWwmB5CwobeaZ\/29dZHC5P3sqaRs1UwimjHF\/qIztB3g\/H+iV4g=:utf-8"},"name":"db_server_creds"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"zoDn9OhBDHikGeoltOWEvNnnoP9d0ky7JgJdBU74R+gFbIsHf9c0kCB6:utf-8"},"name":"era_creds"},{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"NInpwxRdjPAv\/VqooOY6S1PoS2e77PXpeM0OV3\/k2boAS8QdsaymPlv0JII6oS0PBhSKKjyZE4LWNi3yWr8VBhtLWEciWwcVM5kLJtBdwj+CGAqRWU761CyON4kfNTh9JLi5iY1qmp6dlPA0F8wEKP67rYHhraMb6vEwg9r6S27052SaJEzoAEMcnW5McbyPKLjRsknklXyLjAwWQwpTY4GSanVRZsBKFNpMrFPlZ3fAZos95vNzaEhVdwS0hGPxogWm5LvKAbnNof1QZQ+VCVtAZ9xHcOdCi+RopwsSBAHQWXcxiIPWLclQXF7A8MNeWAeRV6xrcKdz8EC1rBVa466l4KcjNc5oaLFpQiyYJVsg9DKMu7CaDPkx997bchlPNgRxBrTJ2o95dh6Xru0AcV6wu4AYWvctzvukoyyMQ6pj\/iJ63M\/+fkIyqRBgKnMUPc92zuuI\/jaDSCTckogNOqIu2j6Vziw0pP0MCFo7hCMpocraK59TkWFo7XI3COV95xQTKtdviDR0zrgu1IV+eNEmeMCgjLkH\/sYafbfgUEwnXAjO1gKTFW9agyTXrKkgx1gfb2WiJ11\/13pF+0MWTtpBc+ERm5zqRBvBb0krrD2YuMfI8om7xv3qhZRvoFWWSGDz\/wA7wM0E83K4uyeNZLwoeqrlBP8fVGup+W+m9h9VKGshi8zdkJAb+LLL\/wR7IyXL7+9jxbKqURAde3ojkaQGtHFK6OTurfRrgKVNfJUz1Vyfadl\/70YHgdFi2QoG4Un6qdVZ\/KyPHbklCoWQQh+nJ\/mFl5wAqYDJOop9Tj\/X4Lvf7HH0OqyS0WtDRx21+6euIUm\/eBFYNsDMLT5eNOBXtHJen7IAd1CL3e3K5WUXivOkLTCmxHJvkbXCINUzq+\/yQcRqg0WK3Od8ncxSAfoOMwVGtW1XGRu6sddOwkwtUZVUI8SBbVkzTGWAI6Z4ffNoIz35iNT3qm2bYmIGzY6LY9GMaS2ZU4lTdz5Prhjuf6XrjjEkQWGqyA7b9Xd9xJGS7wXOI8zYE5i0PE1U7Ai+puaDdqF03OQGbmwjzlVQve\/+ahtDKOFr8\/recWTrf8zUeElAlsApYs\/iYhQ9j0XoLAke92ZSwuUIFuLa+EQ5Fr0GYn\/89P7CGUYq83Zlzyw3Z6C+ZcfoxgQeS8jEnIoXSQU9zgym07Np22r9QuiR7er+QC915jg8TM9J8a6mBmggyBlt2hTLEUmJVJhKU4Su7eMpiQaNDnRNAA1qEw2m6R4T2AQGEoKQN\/8GBlAGIlclELEr0gKr133C9ofFABlqgxKBqAKXVKgehBXkVnRfu\/Z7TCAxhZt7xXbhLoPPXfeMq+UMZBDjgbI3PmZRzGA7pfm79YQaqm4jqPQsIXx0voWsvdazbJmZ8vcNKO9Q\/DGrYxznFfm+AoykW6Im5umGzSz8eonlWdMAT4xGE1WlA+MenzhysUBianVUQcR9hGIsRXazojWLVususaE23yNQ11FAVWm9NCFz27MsJRFcsEtlLn0K2SuLfgBQQaumZ2yUXu+6W7TK+dMhZuntgu93wtmeAKWtaEDqwCffZuvmtSHjBSoCgADhuEKIgORg2JWGWK9ES3GHovBWwlUbpXq4d8pEII0p5IYoI+Ek9Kwtqi8qQ1o38pwVvfQLiVx06tTmptvRGKlRIRIOMDKS71NcDuKZnxUdAtLagUvmvrzFbNjs5jOtxHM8xDoPUWUpllGexfx\/N2Dy19X2Eqjw7QmRnlgda3yexzKTMDW2K7B9c\/srYVSki3b03rkJ8n80OMX0QHyPA2jGrkZz+CEjSCno5\/diD3grOViZTp5LNZFpJPg0TyODaQIhsXw5OcByzmLK1qcZwTLKfVmOj+\/3ktM73t0jE3mNiGC3gCClPGwgCAjlq63WklzfDQGw5JBqFEdHjX23rXkELCLDsGP8jmbMIpzz\/r215G7ShuaWFOhCDaSkZoohqejkRW1aNCGpdZk6cKOtoe3BsJcoeiwCgRh4KfKdqcr2xMTBzBAAPgbcDmUY2+Y9tg2oCGvf8qLz5tHQtK2NpFWJdUeo9baqSjwwJilY2nsEgUOs6++UMzXkjDABjGplKbDXHlQoSjUwY812+oWy8kvZnqKH2jciX+8QB+r5o69slFS4IFxHyIIMwlcuN61NN+rrGXO8aNo8K4X4Ryt3+i6OTB03kkuW9UfTvNqbeTTligmtlB0pew56mN1NR65YtEXXh4M7+LmOHNC6F2xNWL0pM3JR+ZAgS2LbdSBPmKAUr7c=:utf-8"},"name":"centos"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Era"}],"name":"EraPackage","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"EraPackage"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"GetClusterID"},{"kind":"app_task","name":"GetProfileIDs"},{"kind":"app_task","name":"GetSLAID"},{"kind":"app_task","name":"ProvisionDB"},{"kind":"app_task","name":"MonitorOperation"},{"kind":"app_task","name":"GetDatabaseInfo"}],"name":"7bd63f34_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"GetClusterID"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"GetProfileIDs"}},{"from_task_reference":{"kind":"app_task","name":"GetProfileIDs"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"GetSLAID"}},{"from_task_reference":{"kind":"app_task","name":"GetSLAID"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ProvisionDB"}},{"from_task_reference":{"kind":"app_task","name":"MonitorOperation"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"GetDatabaseInfo"}},{"from_task_reference":{"kind":"app_task","name":"ProvisionDB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MonitorOperation"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetClusterID","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/clusters\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])","eval_variables":["CLUSTER_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetProfileIDs","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Software Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Software&name=@@{software_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"SOFTWARE_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Compute&name=@@{compute_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"COMPUTE_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Network&name=@@{network_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Database_Parameter&name=@@{database_parameter}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"DB_PARAM_ID={0}\".format(json.loads(resp.content)['id'])","eval_variables":["COMPUTE_PROF_ID","DB_PARAM_ID","NETWORK_PROF_ID","SOFTWARE_PROF_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetSLAID","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get the list of SLAs\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/slas\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n\n# Find the desired SLA, and set the corresponding ID to the variable\nfor sla in json.loads(resp.content):\n  if sla['name'] == \"@@{sla_name}@@\":\n    print \"SLA_ID={0}\".format(sla['id'])","eval_variables":["SLA_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ProvisionDB","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Set the URL and payload\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/provision\"\npayload = {\n  \"databaseName\": \"@@{db_name}@@\",\n  \"databaseType\": \"postgres_database\",\n  \"databaseDescription\": \"Postgres database provisioned by Calm Application @@{calm_application_name}@@\",\n  \"clusterId\": \"@@{CLUSTER_ID}@@\",\n  \"softwareProfileId\": \"@@{SOFTWARE_PROF_ID}@@\",\n  \"computeProfileId\": \"@@{COMPUTE_PROF_ID}@@\",\n  \"networkProfileId\": \"@@{NETWORK_PROF_ID}@@\",\n  \"dbParameterProfileId\": \"@@{DB_PARAM_ID}@@\",\n  \"provisionInfo\": [\n    {\n      \"name\": \"application_type\",\n      \"value\": \"postgres_database\"\n    },\n    {\n      \"name\": \"listener_port\",\n      \"value\": \"5432\"\n    },\n    {\n      \"name\": \"database_size\",\n      \"value\": \"200\"\n    },\n    {\n      \"name\": \"working_dir\",\n      \"value\": \"\/tmp\"\n    },\n    {\n      \"name\": \"auto_tune_staging_drive\",\n      \"value\": True\n    },\n    {\n      \"name\": \"db_password\",\n      \"value\": \"@@{db_password}@@\"\n    },\n    {\n      \"name\": \"dbserver_name\",\n      \"value\": \"PostgreSQL-@@{calm_time}@@\"\n    },\n    {\n      \"name\": \"dbserver_description\",\n      \"value\": \"Postgres database server provisioned by Calm Application @@{calm_application_name}@@\"\n    },\n    {\n      \"name\": \"ssh_public_key\",\n      \"value\": \"@@{db_public_key}@@\"\n    }\n  ],\n  \"timeMachineInfo\": {\n    \"name\": \"PostgreSQL-@@{calm_time}@@_TM\",\n    \"description\": \"PostgreSQL-@@{calm_time}@@ time machine\",\n    \"slaId\": \"@@{SLA_ID}@@\",\n    \"schedule\": {\n      \"continuousSchedule\": {\n        \"enabled\": True,\n        \"logBackupInterval\": 30,\n        \"snapshotsPerDay\": 30\n      },\n      \"snapshotTimeOfDay\": {\n        \"hours\": 1,\n        \"minutes\": 0,\n        \"seconds\": 0\n      },\n      \"weeklySchedule\": {\n        \"enabled\": True,\n        \"dayOfWeek\": \"SUNDAY\"\n      },\n      \"monthlySchedule\": {\n        \"enabled\": True,\n        \"dayOfMonth\": 1\n      },\n      \"quartelySchedule\": {\n        \"enabled\": True,\n        \"startMonth\": \"JANUARY\",\n        \"dayOfMonth\": 1\n      },\n      \"yearlySchedule\": {\n        \"enabled\": False,\n        \"month\": \"DECEMBER\",\n        \"dayOfMonth\": 1\n      }\n    }\n  }\n}\n\n# Make the call and set the response operation ID to the variable\nresp = urlreq(url, verb='POST', auth='BASIC', user=era_user, passwd=era_pass, params=json.dumps(payload), headers=headers)\nprint \"CREATE_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","eval_variables":["CREATE_OPERATION_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MonitorOperation","attrs":{"exit_status":[],"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{CREATE_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(30):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)\n\n# Get the newly provision DB Entity Name and set it to a variable\nprint \"DB_ENTITY_NAME={0}\".format(json.loads(resp.content)['entityName'])","eval_variables":["DB_ENTITY_NAME"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"GetDatabaseInfo","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get DB Server IP and ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/name\/@@{DB_ENTITY_NAME}@@?detailed=true\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n\nif resp.ok:\n#print json.dumps(json.loads(resp.content), indent=2)\n  print \"DB_SERVER_IP={0}\".format(json.loads(resp.content)['hostIP'])\n  print \"DB_ID={0}\".format(json.loads(resp.content)['id'])\n  print \"DB_SERVER_ID={0}\".format(json.loads(resp.content)['primaryHost'])\n  # Get DB Server Name\n  url     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/dbservers\/\" + json.loads(resp.content)['primaryHost']\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  #print json.dumps(json.loads(resp.content), indent=2)\n  if resp.ok:\n    print \"DB_SERVER_NAME={0}\".format(json.loads(resp.content)['name'])\n\n    prop = json.loads(resp.content)['properties']\n    for i in prop:\n      if i[\"name\"] == \"vm_cluster_uuid\":\n        print \"DB_SERVER_VM_UUID={0}\".format(i[\"value\"])\n  else:\n    print \"Error executing api to retrieve database server {0} Response: {1}\".format(resp.status_code, resp.text)  \n\nelse:\n  print \"Error executing api to retrieve database information: {0} Response: {1}\".format(resp.status_code, resp.text)  \n\n","eval_variables":["DB_ID","DB_SERVER_ID","DB_SERVER_IP","DB_SERVER_NAME","DB_SERVER_VM_UUID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"a56589a3_runbook","main_task_local_reference":{"kind":"app_task","name":"7bd63f34_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"EraPackage"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CleanupDB"},{"kind":"app_task","name":"MonitorCleanupOp"},{"kind":"app_task","name":"DeregisterDBServer"},{"kind":"app_task","name":"MonitorDeregOp"}],"name":"99b487fd_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"CleanupDB"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MonitorCleanupOp"}},{"from_task_reference":{"kind":"app_task","name":"DeregisterDBServer"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MonitorDeregOp"}},{"from_task_reference":{"kind":"app_task","name":"MonitorCleanupOp"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"DeregisterDBServer"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CleanupDB","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Cleanup the DB and get Operation ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/@@{DB_ID}@@?storage-cleanup=true&tm-cleanup=true\"\nresp = urlreq(url, verb='DELETE', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"CLEANUP_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","eval_variables":["CLEANUP_OPERATION_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MonitorCleanupOp","attrs":{"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{CLEANUP_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 10 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DeregisterDBServer","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Cleanup the DB and get Operation ID\nurl = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/dbservers\/@@{DB_SERVER_ID}@@?soft-remove=false&remove=false&delete=true&delete-vm-snapshots=true&delete-vgs=true\"\nresp = urlreq(url, verb='DELETE', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"DEREGISTER_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","eval_variables":["DEREGISTER_OPERATION_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MonitorDeregOp","attrs":{"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{DEREGISTER_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 10 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a8f36ab1_runbook","main_task_local_reference":{"kind":"app_task","name":"99b487fd_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Postgres"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"58ca4a03_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"8b1f1a7b_runbook","main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ee8bedbe_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"faacff5d_runbook","main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Flow"}],"name":"Package4","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package4"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Create Category"},{"kind":"app_task","name":"Create Policy"}],"name":"ea12c7be_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Create Category"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Create Policy"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Create Category","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3b58a035_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Create Policy","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"172074d8_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"0ebc908d_runbook","main_task_local_reference":{"kind":"app_task","name":"ea12c7be_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package4"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Delete Policy"},{"kind":"app_task","name":"Delete Category"}],"name":"c75d107a_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Delete Policy"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Delete Category"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Delete Policy","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"b0ce783a_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Delete Category","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"771ebc6f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"2e52a8a4_runbook","main_task_local_reference":{"kind":"app_task","name":"c75d107a_dag"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"f6be2786_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"Era_PostgreSQL_DB"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"f9a4c530_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"EraPackage"}],"substrate_local_reference":{"kind":"app_substrate","name":"EraServer"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"17264844_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package4"}],"substrate_local_reference":{"kind":"app_substrate","name":"FlowIngegration"},"variable_list":[],"description":""}],"environment_reference_list":[],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Task1"},{"kind":"app_task","name":"Task2"},{"kind":"app_task","name":"Task4"}],"name":"c1a51ce5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Era"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task1","attrs":{"type":"","interval_secs":120},"timeout_secs":"0","type":"DELAY","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Postgres"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task2","attrs":{"type":"","interval_secs":120},"timeout_secs":"0","type":"DELAY","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Flow"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task4","attrs":{"type":"","interval_secs":120},"timeout_secs":"0","type":"DELAY","variable_list":[]}],"description":"","name":"21a8f06f_runbook","main_task_local_reference":{"kind":"app_task","name":"c1a51ce5_dag"},"variable_list":[]},"name":"Useless Action"}],"name":"Default","variable_list":[{"regex":{"should_validate":false,"value":"[Dd][Ee][Ff][Aa][Uu][Ll][Tt].*"},"val_type":"STRING","is_mandatory":true,"description":"select DEFAULT_OOB_COMPUTE","data_type":"BASE","type":"EXEC_LOCAL","name":"compute_profile","value":"","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"EXEC","attrs":{"script":"\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nera_user = 'admin'\nera_pass = 'ntnx\/4STEM'\nera_ip = '10.42.94.22'\n\n\n# Get Compute Profile ID\nurl     = \"https:\/\/\" + era_ip + \":8443\/era\/v0.8\/profiles?type=Compute\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n#print \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\na = ''\nfor i in resp.json():\n  a = a + i['name'] + ','\nprint re.sub(',$', '', a)","type":"EXEC","command_line_args":"","exit_status":[],"script_type":"static"}}},{"regex":{"should_validate":false,"value":".*[Pp][Oo][Ss][Tt][Gg][Rr][Ee][Ss].*"},"val_type":"STRING","is_mandatory":true,"description":"select relevant to POSTGRES","data_type":"BASE","type":"EXEC_LOCAL","name":"database_parameter","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"EXEC","attrs":{"script":"headers = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nera_user = 'admin'\nera_pass = 'ntnx\/4STEM'\nera_ip = '10.42.94.22'\n\n# Get Compute Profile ID\nurl     = \"https:\/\/\" + era_ip + \":8443\/era\/v0.8\/profiles?type=Database_Parameter\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n#print \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\na = ''\nfor i in resp.json():\n  a = a + i['name'] + ','\nprint re.sub(',$', '', a)","type":"EXEC","command_line_args":"","exit_status":[],"script_type":"static"}}},{"regex":{"should_validate":false,"value":"[Pp][Oo][Ss][Tt][Gg][Rr][Ee][Ss].*"},"val_type":"STRING","is_mandatory":true,"description":"select relevant to POSTGRES (no HA)","data_type":"BASE","type":"EXEC_LOCAL","name":"software_profile","value":"","label":"","editables":{"value":true},"is_hidden":false,"options":{"type":"EXEC","attrs":{"script":"\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nera_user = 'admin'\nera_pass = 'ntnx\/4STEM'\nera_ip = '10.42.94.22'\n\n# Get Compute Profile ID\nurl     = \"https:\/\/\" + era_ip + \":8443\/era\/v0.8\/profiles?type=Software\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n#print \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\na = ''\nfor i in resp.json():\n  a = a + i['name'] + ','\nprint re.sub(',$', '', a)","type":"EXEC","command_line_args":"","exit_status":[],"script_type":"static"}}},{"regex":{"should_validate":false,"value":"[Pp][Oo][Ss][Tt][Gg][Rr][Ee][Ss].*"},"val_type":"STRING","is_mandatory":true,"description":"select relevant to POSTGRES","data_type":"BASE","type":"EXEC_LOCAL","name":"network_profile","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"EXEC","attrs":{"script":"\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nera_user = 'admin'\nera_pass = 'ntnx\/4STEM'\nera_ip = '10.42.94.22'\n\n# Get Compute Profile ID\nurl     = \"https:\/\/\" + era_ip + \":8443\/era\/v0.8\/profiles?type=Network\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n#print \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\na = ''\nfor i in resp.json():\n  a = a + i['name'] + ','\nprint re.sub(',$', '', a)","type":"EXEC","command_line_args":"","exit_status":[],"script_type":"static"}}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"db_name","value":"oscar_django_@@{calm_time(\"%Y%m%d%H%M\")}@@","label":"","is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"db_password","value":"nutanix","label":"","is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"db_public_key","value":"ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAii7qFDhVadLx5lULAG\/ooCUTA\/ATSmXbArs+GdHxbUWd\/bNGZCXnaQ2L1mSVVGDxfTbSaTJ3En3tVlMtD2RjZPdhqWESCaoj2kXLYSiNDS9qz3SK6h822je\/f9O9CzCTrw2XGhnDVwmNraUvO5wmQObCDthTXc72PcBOd6oa4ENsnuY9HtiETg29TZXgCYPFXipLBHSZYkBmGgccAeY9dq5ywiywBJLuoSovXkkRJk3cd7GyhCRIwYzqfdgSmiAMYgJLrz\/UuLxatPqXts2D8v1xqR9EPNZNzgd4QHK4of1lqsNRuz2SxkwqLcXSw0mGcAL8mIwVpzhPzwmENC5Orw== rsa-key-20190108","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"era_ip","value":"10.42.94.22","label":"","attrs":{"type":"LOCAL"},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"sla_name","value":"DEFAULT_OOB_BRASS_SLA","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"download_host","value":"","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"download_port","value":"","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"pc_ip","value":"10.42.94.39","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"pc_username","value":"admin","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"pc_password","value":"3DF9PnoBjZ5nSKUpDPRe8aPeFsAlrobwUUFVzgRhvQ07XY1EmXn662Fr:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"is_hidden":false}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"centos"},"type":"USER"},"name":"Postgres-ERA"},"api_version":"3.0","metadata":{"last_update_time":"1617784410643861","kind":"blueprint","spec_version":2,"creation_time":"1617784153738809","name":"Postgres-ERA"}}